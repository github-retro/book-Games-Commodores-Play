10 REM *********************
11 REM ***               ***
12 REM *** BARREL OF FUN ***
13 REM ***               ***
14 REM *********************
15 REM
16 REM
20 GOSUB 1000: REM INSTRUCTIONS
30 GOSUB 2000: REM SETUP
40 GOSUB 3000: REM PLAY
50 GOSUB 4000: REM END
60 END
1000 :
1001 REM *** INSTRUCTIONS
1002 :
1005 POKE 53281,12: POKE 53280,12
1010 PRINT "{clear}{black}";
1020 PRINT TAB(10)"*** BARREL OF FUN ***": PRINT: PRINT
1030 PRINT "IN BARREL OF FUN YOU WILL SEE THREE"
1031 PRINT "COLUMNS OF SIX COLORFUL BARRELS. THE"
1032 PRINT "OBJECT OF THE GAME IS TO ALLIGN THE ROWS";
1033 PRINT "SUCH THAT EACH ROW IS A SOLID COLOR."
1034 PRINT "THERE ARE ONLY TWO WHITE BARRELS. THE"
1035 PRINT "EMPTY SQUARE MUST EVENTUALLY COMPLETE"
1036 PRINT "THE WHITE ROW."
1040 PRINT: PRINT "THE BOARD OF SQUARES WILL BE MISED UP,"
1041 PRINT "AND YOUR TASK IS TO UNSCRABMLE IT. THE ";
1042 PRINT "FINAL PRODUCT SHOULD HAVE ALL OF THE "
1043 PRINT "SQUARES OF ONE COLOR LINE UP IN A"
1044 PRINT "HORIZONTAL ROW."
1045 PRINT
1050 PRINT "A SAMPLE OF HOW THE FINISHED PRODUCT"
1051 PRINT "SHOULD LOOK WILL BE SHOWN TO YOU."
1052 PRINT
1060 PRINT "PRESS RETURN TO CONTINUE."
1065 GET ANS$: IF ANS$<>CHR$(13) THEN GOTO 1065
1070 PRINT "{clear}{black}";
1071 PRINT TAB(10)"*** BARREL OF FUN ***": PRINT: PRINT
1080 PRINT "EACH COLUMN OF SQUARES (COLUMNS 1,2,3)"
1081 PRINT "CAN BE ROTATED VERTICALLY BY ENTERING"
1082 PRINT "THE NUMBER OF THE COLUMN YOU WISH TO"
1083 PRINT "ROTATE."
1090 PRINT: PRINT "YOU CAN MOVE COLORED SQUARE INTO THE"
1091 PRINT "EMPTY SQUARE BY USING THE F1 AND F3"
1092 PRINT "KEYS. IF THE COLORED SQUARE IS TO BE"
1093 PRINT "MOVED TO THE EMPTY SQUARE ON ITS RIGHT"
1094 PRINT "THEN PRESS F3."
1095 PRINT: PRINT "IF THE COLORED SQUARE IS TO BE MOVED TO"
1096 PRINT "THE EMPQY SQUARE ON ITS LEFT THEN PRESS"
1097 PRINT "F1."
1100 PRINT
1101 PRINT "PRESS RETURN TO CONTINUE."
1105 GET ANS$: IF ANS$<>CHR$(13) THEN GOTO 1105
1120 PRINT "{clear}{black}";
1121 PRINT TAB(10)"*** BARREL OF FUN ***": PRINT: PRINT
1130 PRINT "NOTE THAT IN THE FINAL SOLUTION ALL"
1131 PRINT "HORIZONTAL ROWS MUST BE THE SAME COLOR."
1132 PRINT: PRINT "IT DOESN'T MATTER WHERE THE ROW IS"
1133 PRINT "LOCATED, AS LONG AS ALL OF THE COLORS"
1134 PRINT "WITHIN THE ROW ARE THE SAME."
1140 PRINT
1141 PRINT "PRESS RETURN TO CONTINUE."
1145 GET ANS$: IF ANS$<>CHR$(13) THEN GOTO 1145
1990 RETURN
2000 :
2001 REM *** SETUP
2002 :
2005 DIM BA(3,6),CO$(6): FOR I=0 TO 6: READ CO$(I): NEXT
2006 DATA "{dark gray}","{black}","{red}","{light green}","{blue}","{cyan}","{white}"
2010 FOR I=1 TO 6: FOR J=1 TO 3: BA(J,I)=I: NEXT: NEXT: BA(3,6)=0: BX=3: BY=6
2020 PLT=49152: FOR I=0 TO 24: READ C: POKE PLT+I,C: NEXT I
2021 DATA 32,16,192,132
2022 DATA 253,32,16,192
2023 DATA 152,170,164,253
2024 DATA 24,76,240,255
2025 DATA 32,253,174,32
2026 DATA 158,173,76,170,177
2030 PRINT "{clear}{yellow}"
2034 FOR I=0 TO 18 STEP 3: SYS PLT,11,I: PRINT "{reverse on}-------------------": NEXT
2040 FOR I=1 TO 3: GOSUB 2500: NEXT
2100 SYS PLT,0,20: FOR I=1 TO 3: PRINT "{reverse off}                                        "
2105 SYS PLT,5,20: PRINT "{black}<<< THIS IS THE FINAL PATTERN >>>"
2110 FOR PA=1 TO 2000: NEXT PA
2115 SYS PLT,0,20: PRINT "{reverse off}                                        "
2116 SYS PLT,3,20: PRINT "{black}<<< I'M NOW SCRAMBLING THE BOARD >>>"
2120 FOR N=1 TO 20+INT(10*RND(0))
2130 IF BX=3 THEN RX=2: GOTO 2140
2131 IF BX=1 THEN RX=2: GOTO 2140
2132 RX=1+2*INT(2*RND(0))
2140 FOR L=1 TO 1+INT(5*RND(0)): FOR M=1 TO 6: BA(RX,M-1)=BA(RX,M): NEXT M
2141 BA(RX,6)=BA(RX,0): I=RX: NEXT L: GOSUB 2500
2145 BA(BX,BY)=BA(RX,BY): BA(RX,BY)=0
2150 I=BX: J=BY: GOSUB 2510
2155 BX=RX: I=BX: J=BY: GOSUB 2510
2160 NEXT N: RETURN
2200 RETURN
2230 FOR N=1 TO 20+INT(10*RND(0))
2235 IF BX=3 THEN RX=2: GOTO 
2500 FOR J=1 TO 6: GOSUB 2510: NEXT J: RETURN
2510 PRINT CO$(BA(I,J));
2520 FOR K=0 TO 1: SYS PLT,(I+1)*6,J*3-2+K: PRINT "{reverse on}     ";: NEXT K: RETURN
2990 RETURN
3000 :
3001 REM *** PLAY
3002 :
3010 SYS PLT,0,20: PRINT "{reverse off}                                        "
3011 SYS PLT,6,20: PRINT "{black}{reverse on}  TYPE 1 TO ROTATE COLUMN 1 "
3012 PRINT TAB(6)"{reverse on}  TYPE 2 TO ROTATE COLUMN 2 "
3013 PRINT TAB(6)"{reverse on}  TYPE 3 TO ROTATE COLUMN 3 "
3014 PRINT TAB(6)"{reverse on} 4 SHIFT LEFT 5 TO SHIFT RIGHT";
3020 GET KEY$: IF KEY$="" THEN GOTO 3020
3030 IF KEY$="1" OR KEY$="2" OR KEY$="3" THEN GOTO 3100
3035 IF KEY$="4" THEN GOTO 3050 
3040 IF KEY$="5" THEN GOTO 3075
3045 GOTO 3020
3050 RX=BX+1: IF RX=4 THEN GOTO 3020
3055 BA(BX,BY)=BA(RX,BY): BA(RX,BY)=0
3060 I=BX: J=BY: GOSUB 2510: BX=RX: I=BX: J=BY: GOSUB 2510
3065 GOTO 3500
3075 RX=BX-1: IF RX=0 THEN GOTO 3020
3080 BA(BX,BY)=BA(RX,BY): BA(RX,BY)=0
3085 I=BX: J=BY: GOSUB 2510: BX=RX: I=BX: J=BY: GOSUB 2510
3090 GOTO 3500
3100 RX=VAL(KEY$)
3110 FOR M=1 TO 6: BA(RX,M-1)=BA(RX,M): NEXT M: BA(RX,6)=BA(RX,0): I=RX: GOSUB 2500
3120 IF RX=BX THEN BY=BY-1: IF BY=0 THEN BY=6
3500 BA(BX,BY)=6: FOR I=1 TO 6
3510 IF BA(1,I)=BA(2,I) AND BA(2,I)=BA(3,I) THEN NEXT I: RETURN
3520 BA(BX,BY)=0: TRY=TRY+1: GOTO 3020
3990 RETURN
4000 :
4001 REM *** END
4002 :
4990 RETURN
